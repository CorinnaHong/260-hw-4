---
title: "HW4"
author: "Corinna Hong"
date: "February 24, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.align = "center")
```

```{r}

# load packages

library(tidyverse)
library(janitor)

```

```{r}

# read in and wrangle climate change data

climate_change <- read_csv("climate_change.csv") %>% 
  clean_names() %>% 
  mutate(geographic_range = str_to_lower(geographic_range))

```

```{r, visualizing patterns of change for climate change data}

# Visualize changes in density due to development mode

climate_dev_bar <- ggplot(climate_change,
                          aes(x = species,
                              y = change_in_density,
                              fill = development_mode)) +
  geom_bar (stat = "identity") + # identity means height of bars equals actual value
  theme_minimal()

climate_dev_bar



# Visualize changes in density due to geographic range

climate_geo_bar <- ggplot(climate_change,
                          aes(x = species,
                              y = change_in_density,
                              fill = geographic_range)) +
  geom_bar(stat = "identity") +
  theme_minimal()

climate_geo_bar # PATTERN: Southern species increase, Northern species decreased.



# Visualize changes in density due to trophic level

climate_tro_bar <- ggplot(climate_change,
                          aes(x = species,
                              y = change_in_density,
                              fill = trophic_level)) +
  geom_bar(stat = "identity") +
  theme_minimal()

climate_tro_bar


```

```{r}

# Read in and wrangle data for nuclear power plant

nuclear_power <- read_csv("nuclear_power.csv") %>% 
  clean_names() %>% 
  gather(`hyperion_bay`,`noway_bay`,`diablo_cove`, key = "site", value = "density") # Density measured in (# of individuals/100m2)

```

```{r, visualizing patterns of change for nuclear power}

# Visualize change in all species across all sites

nuclear_species <- ggplot(nuclear_power, aes(x = year, y = density, fill = site)) +
  geom_line(aes(color = site)) +
  facet_wrap(~species, scale = "free", nrow = 3) +
  theme_minimal()

nuclear_species

```

```{r}

# Read in data for crab fishery


```

